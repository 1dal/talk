machine:
  node:
    version: 7
  services:
    - docker
    - redis

test:
  override:
    - npm run lint
    - ./bin/cli settings init
    - MOCHA_FILE=$CIRCLE_TEST_REPORTS/junit/test-results.xml ./node_modules/.bin/mocha tests --reporter mocha-junit-reporter

deployment:
  release:
    tag: /[0-9]+(\.[0-9]+)*/
    commands:
      - bash ./scripts/deploy.sh

  latest:
    branch: master
    commands:
      - bash ./scripts/deploy.sh
